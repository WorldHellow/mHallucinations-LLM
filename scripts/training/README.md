The code is adapted from BiLLM library. 